{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/macbook/Documents/blog/components/home-page/form.tsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useContext, useEffect } from \"react\";\nimport { Context } from \"~/context/context\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport axios from \"axios\";\n\nvar Form = function Form(_ref) {\n  _s();\n\n  var initialData = _ref.initialData;\n\n  var _ref2 = useContext(Context),\n      setAllPosts = _ref2.setAllPosts,\n      setData = _ref2.setData,\n      data = _ref2.data;\n\n  var _useState = useState({\n    title: (initialData === null || initialData === void 0 ? void 0 : initialData.title) || '',\n    body: (initialData === null || initialData === void 0 ? void 0 : initialData.body) || ''\n  }),\n      formData = _useState[0],\n      setFormData = _useState[1];\n\n  var title = formData.title,\n      body = formData.body;\n  useEffect(function () {\n    setData({\n      title: (initialData === null || initialData === void 0 ? void 0 : initialData.title) || '',\n      body: (initialData === null || initialData === void 0 ? void 0 : initialData.body) || ''\n    });\n  }, []);\n\n  var handleChange = function handleChange(e) {\n    setFormData(_objectSpread(_objectSpread({}, formData), {}, _defineProperty({}, e.target.name, e.target.value)));\n    setData(_objectSpread(_objectSpread({}, data), {}, _defineProperty({}, e.target.name, e.target.value)));\n  };\n\n  var mutation = useMutation( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var response;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return axios.post(\"https://jsonplaceholder.typicode.com/posts\", {\n              title: title,\n              body: body,\n              userId: 1\n            }, {\n              headers: {\n                \"Content-type\": \"application/json; charset=UTF-8\"\n              }\n            });\n\n          case 3:\n            response = _context.sent;\n            return _context.abrupt(\"return\", response.data);\n\n          case 7:\n            _context.prev = 7;\n            _context.t0 = _context[\"catch\"](0);\n            throw _context.t0;\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[0, 7]]);\n  })), {\n    onSuccess: function onSuccess(data) {\n      console.log(\"Successful\", {\n        data: data\n      });\n      setFormData({\n        title: \"\",\n        body: \"\"\n      });\n    },\n    onError: function onError(error) {\n      console.log(\"Failed\", {\n        error: error\n      });\n    },\n    onSettled: function onSettled(res) {\n      setAllPosts(function (prev) {\n        return [res].concat(_toConsumableArray(prev));\n      });\n      console.log(\"Mutation completed.\");\n      setFormData({\n        title: \"\",\n        body: \"\"\n      });\n    }\n  });\n\n  function handleSubmitPost(_x) {\n    return _handleSubmitPost.apply(this, arguments);\n  }\n\n  function _handleSubmitPost() {\n    _handleSubmitPost = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e) {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              e.preventDefault();\n              _context2.next = 3;\n              return mutation.mutateAsync();\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _handleSubmitPost.apply(this, arguments);\n  }\n\n  return __jsx(\"form\", {\n    onSubmit: handleSubmitPost,\n    className: \"w-full\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"flex-grow px-2 pt-3 pb-1 relative\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"px-2\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 17\n    }\n  }, __jsx(\"input\", {\n    type: \"text\",\n    name: \"title\",\n    placeholder: \"\\u0639\\u0646\\u0648\\u0627\\u0646 \\u067E\\u0633\\u062A\",\n    value: title,\n    onChange: handleChange,\n    className: \"bg-transparent w-full focus:outline-none text-white bg-dark-lighter text-lg py-2 px-2 rounded-md\",\n    required: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 21\n    }\n  })), __jsx(\"div\", {\n    className: \"px-2 mt-3\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 17\n    }\n  }, __jsx(\"textarea\", {\n    name: \"body\",\n    placeholder: \"\\u062A\\u0648\\u0636\\u06CC\\u062D\\u0627\\u062A\",\n    value: body,\n    onChange: handleChange,\n    className: \"bg-transparent w-full focus:outline-none text-white bg-dark-lighter text-lg pb-1 px-2 py-1 rounded-md\",\n    rows: 4,\n    required: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 11\n    }\n  })), !initialData && __jsx(\"div\", {\n    className: \"flex flex-wrap justify-end mt-5\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 21\n    }\n  }, __jsx(\"div\", {\n    className: \"\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 25\n    }\n  }, __jsx(\"button\", {\n    type: \"submit\",\n    disabled: title.length === 0 || body.length === 0,\n    className: \"text-white px-4 py-2 shadow-sm focus:outline-none font-bold bg-primary rounded-lg \".concat(title.length === 0 || body.length === 0 ? \"cursor-not-allowed opacity-50\" : \"\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 29\n    }\n  }, \"Post\")))));\n};\n\n_s(Form, \"LvIfxcjgxl2iiBylvE7ZKbHqnrs=\", false, function () {\n  return [useMutation];\n});\n\n_c = Form;\nexport default Form;\n\nvar _c;\n\n$RefreshReg$(_c, \"Form\");","map":{"version":3,"sources":["/Users/macbook/Documents/blog/components/home-page/form.tsx"],"names":["React","useState","useContext","useEffect","Context","useMutation","axios","Form","initialData","setAllPosts","setData","data","title","body","formData","setFormData","handleChange","e","target","name","value","mutation","post","userId","headers","response","onSuccess","console","log","onError","error","onSettled","res","prev","handleSubmitPost","preventDefault","mutateAsync","length"],"mappings":"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","sourcesContent":["import React, {useState, ChangeEvent, useContext, useEffect} from \"react\";\nimport {Context} from \"~/context/context\";\nimport {ContextType,FormData} from \"~/types/static\";\nimport {useMutation} from \"@tanstack/react-query\";\nimport axios from \"axios\";\n\ninterface FormProps {\n    onSubmit?: (data: FormData) => void;\n    initialData?: any[];\n}\nconst Form: React.FC<FormProps> = ({initialData}) => {\n    const { setAllPosts,setData,data } = useContext(Context) as ContextType;\n\n    const [formData, setFormData] = useState<FormData>({\n        title: initialData?.title || '',\n        body: initialData?.body|| '',\n    });\n\n    const { title, body } = formData;\n\n\n    useEffect(()=>{\n        setData({\n            title: initialData?.title || '',\n            body: initialData?.body || ''\n        })\n    },[])\n\n\n    const handleChange = (\n        e: ChangeEvent<HTMLInputElement | HTMLTextAreaElement>\n    ) => {\n        setFormData({\n            ...formData,\n            [e.target.name]: e.target.value,\n        });\n        setData({\n            ...data,\n            [e.target.name]: e.target.value,\n        })\n    };\n\n    const mutation = useMutation(\n        async () => {\n            // eslint-disable-next-line no-useless-catch\n            try {\n                const response = await axios.post(\n                    \"https://jsonplaceholder.typicode.com/posts\",\n                    {\n                        title: title,\n                        body: body,\n                        userId: 1\n                    },\n                    {\n                        headers: {\n                            \"Content-type\": \"application/json; charset=UTF-8\",\n                        },\n                    }\n                );\n                return response.data;\n            } catch (error) {\n                throw error;\n            }\n        },\n        {\n            onSuccess(data) {\n                console.log(\"Successful\", {data});\n                setFormData({title: \"\",\n                    body: \"\",})\n            },\n            onError(error) {\n                console.log(\"Failed\", {error});\n            },\n            onSettled(res) {\n                setAllPosts((prev)=>[res,...prev])\n                console.log(\"Mutation completed.\");\n                setFormData({title: \"\",\n                    body: \"\",})\n            },\n        }\n    );\n\n    async function handleSubmitPost(e:React.FormEvent) {\n        e.preventDefault();\n        await mutation.mutateAsync();\n    }\n\n    return (\n        <form onSubmit={handleSubmitPost} className=\"w-full\">\n            <div className=\"flex-grow px-2 pt-3 pb-1 relative\">\n                <div className=\"px-2\">\n                    <input\n                        type=\"text\"\n                        name=\"title\"\n                        placeholder=\"عنوان پست\"\n                        value={title}\n                        onChange={handleChange}\n                        className=\"bg-transparent w-full focus:outline-none text-white bg-dark-lighter text-lg py-2 px-2 rounded-md\"\n                        required\n                    />\n                </div>\n                <div className=\"px-2 mt-3\">\n          <textarea\n              name=\"body\"\n              placeholder=\"توضیحات\"\n              value={body}\n              onChange={handleChange}\n              className=\"bg-transparent w-full focus:outline-none text-white bg-dark-lighter text-lg pb-1 px-2 py-1 rounded-md\"\n              rows={4}\n              required\n          />\n                </div>\n                {!initialData &&(\n                    <div className=\"flex flex-wrap justify-end mt-5\">\n                        <div className=\"\">\n                            <button\n                                type=\"submit\"\n                                disabled={title.length === 0 || body.length === 0}\n                                className={`text-white px-4 py-2 shadow-sm focus:outline-none font-bold bg-primary rounded-lg ${\n                                    title.length === 0 || body.length === 0\n                                        ? \"cursor-not-allowed opacity-50\"\n                                        : \"\"\n                                }`}\n                            >\n                                Post\n                            </button>\n                        </div>\n                    </div>\n                ) }\n            </div>\n        </form>\n    );\n};\n\nexport default Form;\n"]},"metadata":{},"sourceType":"module"}